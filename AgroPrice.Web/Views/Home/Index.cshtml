@model AgroPrice.Services.WholeSaleMarket.Models.FindProductByWholeSaleMarketModel
@{
    ViewData["Title"] = "Home Page";
}

<div class="cd-section">
    <div class="team-3">
        <div class="container">
            <div class="row">
                <div class="col-md-12 ml-auto mr-auto text-center">
                    <h2 class="title">Tregjet tona</h2>
                    <div class="row">
                        <div class="col-lg-12 col-md-12">
                            <span class="bmd-form-group">
                                <span class="input-group">
                                    @Html.DropDownList("WholeSaleMarketsID", (IEnumerable<SelectListItem>) ViewBag.WholeSaleMarkets, null, new {@class = "form-control"})
                                </span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <br/>
            <div id="search">
               
            </div>
        </div>
    </div>
</div>

@section Scripts{
    <script src="https://cdn.jsdelivr.net/npm/jquery-ajax-unobtrusive@3.2.6/dist/jquery.unobtrusive-ajax.min.js"></script>
    <script>
        $('select[name="WholeSaleMarketsID"]').change(function () {
            debugger;
            var id = $(this).val();
            $.ajax({
                    url: "/Home/FindProductByWholeSaleMarket",
                    type: "POST",
                    data: { WholeSaleMarketsID: id },
                success: (data) => {
                    debugger;
                    //will be better
                        if (data.length > 0) {
                            var i;
                            $('#search').empty();
                            $('#search').show();
                            $('#search').append('<div><div class="table-responsive"><table class="table table-striped table-sm"><thead><tr><th>#</th><th>Produkti</th>' +
                                '<th>Cmimi mesatar</th><th>Sasia e plote</th></tr>'+
                            '<tr>' +
                                '<td>1</td>' +
                                '<td>' +
                                data[0].name +
                                '</td>' +
                                '<td>' +
                                data[0].avaragePrice +
                                '</td>' +
                                '<td>' +
                                data[0].amountSum +
                                '</td>' +
                                '</tr>' +
                                '<tr>' +
                                '<td>2</td>' +
                                '<td>' +
                                data[1].name +
                                '</td>' +
                                '<td>' +
                                data[1].avaragePrice +
                                '</td>' +
                                '<td>' +
                                data[1].amountSum +
                                '</td>' +
                                '</tr>'+
                                '<tr>' +
                                '<td>3</td>' +
                                '<td>' +
                                data[2].name +
                                '</td>' +
                                '<td>' +
                                data[2].avaragePrice +
                                '</td>' +
                                '<td>' +
                                data[2].amountSum +
                                '</td>' +
                                '</tr>'+
                                '<tr>' +
                                '<td>4</td>' +
                                '<td>' +
                                data[3].name +
                                '</td>' +
                                '<td>' +
                                data[3].avaragePrice +
                                '</td>' +
                                '<td>' +
                                data[3].amountSum +
                                '</td>' +
                                '</tr>' +
                                '<tr>' +
                                '<td>5</td>' +
                                '<td>' +
                                data[4].name +
                                '</td>' +
                                '<td>' +
                                data[4].avaragePrice +
                                '</td>' +
                                '<td>' +
                                data[4].amountSum +
                                '</td>' +
                                '</tr>' +
                                '<tr>' +
                                '<td>6</td>' +
                                '<td>' +
                                data[5].name +
                                '</td>' +
                                '<td>' +
                                data[5].avaragePrice +
                                '</td>' +
                                '<td>' +
                                data[5].amountSum +
                                '</td>' +
                                '</tr>' +
                                '<tr>' +
                                '<td>7</td>' +
                                '<td>' +
                                data[6].name +
                                '</td>' +
                                '<td>' +
                                data[6].avaragePrice +
                                '</td>' +
                                '<td>' +
                                data[6].amountSum +
                                '</td>' +
                                '</tr>' +
                                '<tr>' +
                                '<td>8</td>' +
                                '<td>' +
                                data[7].name +
                                '</td>' +
                                '<td>' +
                                data[7].avaragePrice +
                                '</td>' +
                                '<td>' +
                                data[7].amountSum +
                                '</td>' +
                                '</tr>' +
                                '<tr>' +
                                '<td>9</td>' +
                                '<td>' +
                                data[8].name +
                                '</td>' +
                                '<td>' +
                                data[8].avaragePrice +
                                '</td>' +
                                '<td>' +
                                data[8].amountSum +
                                '</td>' +
                                '</tr>'

                                 );
                            
                            
                        } 
                    
                    }
            });
        })
    </script>
}